<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Additional Generic Views &#8212; Effective Django</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0-pre',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Form Basics" href="forms.html" />
    <link rel="prev" title="Using Static Assets" href="static.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="additional-generic-views">
<h1>Additional Generic Views<a class="headerlink" href="#additional-generic-views" title="Permalink to this headline">¶</a></h1>
<div class="section" id="edit-views">
<h2>Edit Views<a class="headerlink" href="#edit-views" title="Permalink to this headline">¶</a></h2>
<p>In addition to creating Contacts, we&#8217;ll of course want to edit them.
As with the List and Create views, Django has a generic view we can
use as a starting point.</p>
<ul class="simple">
<li>we can re-use the same template</li>
<li>but how does it know which contact to load?</li>
<li>we need to either: provide a pk/slug, or override get_object().</li>
<li>we&#8217;ll provide pk in the URL</li>
</ul>
<p>We&#8217;ll update the contact list to include an edit link next to each
contact.</p>
<p>Note the use of <code class="docutils literal"><span class="pre">pk=contact.id</span></code> in the <code class="docutils literal"><span class="pre">{%</span> <span class="pre">url</span> <span class="pre">%}</span></code> tag to specify
the arguments to fill into the URL pattern.</p>
<p>If you run the server now, you&#8217;ll see an edit link. Go ahead and click
it, and try to make a change. You&#8217;ll notice that instead of editing
the existing record, it creates a new one. Sad face.</p>
<p>If we look at the source of the edit HTML, we can easily see the
reason: the form targets <code class="docutils literal"><span class="pre">/new</span></code>, not our edit URL. To fix this &#8211;
and still allow re-using the template &#8211; we&#8217;re going to add some
information to the template context.</p>
<p>The template context is the information available to a template when
it&#8217;s rendered. This is a combination of information you provide in
your view &#8211; either directly or indirectly &#8211; and information added by
<a class="reference external" href="https://docs.djangoproject.com/en/1.5/ref/templates/api/#subclassing-context-requestcontext">context processors</a>, such as the location for static media and
current locale. In order to use the same template for add and edit,
we&#8217;ll add information about where the form should redirect to the
context.</p>
<p>We also update the template to use that value for the action and
change the title based on whether or not we&#8217;ve previously saved.</p>
<p>You may wonder where the <code class="docutils literal"><span class="pre">contact</span></code> value in the contact comes from:
the class based views that wrap a single object (those that take
a primary key or slug) expose that to the context in two different
ways: as a variable named <code class="docutils literal"><span class="pre">object</span></code>, and as a variable named after
the model class. The latter often makes your templates easier to read
and understand later. You can customize this name by overriding
<code class="docutils literal"><span class="pre">get_context_object_name</span></code> on your view.</p>
<div class="sidebar">
<p class="first sidebar-title">Made a Change? Run the Tests.</p>
<p>We&#8217;ve just made a change to our <code class="docutils literal"><span class="pre">CreateContactView</span></code>, which means
this is a perfect time to run the tests we wrote. Do they still pass?
If not, did we introduce a bug, or did the behavior change in a way
that we expected?</p>
<p class="last">(Hint: We changed how the contact list is rendered, so our tests
that just expect the name there are going to fail. This is a case
where you&#8217;d need to update the test case, but it also demonstrates
how integration tests can be fragile.)</p>
</div>
</div>
<div class="section" id="deleting-contacts">
<h2>Deleting Contacts<a class="headerlink" href="#deleting-contacts" title="Permalink to this headline">¶</a></h2>
<p>The final view for our basic set of views is delete. The generic
deletion view is very similar to the edit view: it wraps a single
object and requires that you provide a URL to redirect to on success.
When it processes a HTTP GET request, it displays a confirmation page,
and when it receives an HTTP DELETE or POST, it deletes the object and
redirects to the success URL.</p>
<p>We add the view definition to <code class="docutils literal"><span class="pre">views.py</span></code>:</p>
<p>And create the template, <code class="docutils literal"><span class="pre">delete_contact.html</span></code>, in our <code class="docutils literal"><span class="pre">templates</span></code>
directory.</p>
<p>Of course we need to add this to the URL definitions:</p>
<p>And we&#8217;ll add the link to delete to the edit page.</p>
</div>
<div class="section" id="detail-view">
<h2>Detail View<a class="headerlink" href="#detail-view" title="Permalink to this headline">¶</a></h2>
<p>Finally, let&#8217;s go ahead and add a detail view for our Contacts. This
will show the details of the Contact: not much right now, but we&#8217;ll
build on this shortly. Django includes a generic <code class="docutils literal"><span class="pre">DetailView</span></code>: think
of it as the single serving <code class="docutils literal"><span class="pre">ListView</span></code>.</p>
<p>Again, the template is pretty straight forward; we create
<code class="docutils literal"><span class="pre">contact.html</span></code> in the <code class="docutils literal"><span class="pre">templates</span></code> directory.</p>
<p>And add the URL mapping:</p>
<p>We&#8217;re also going to add a method to our Contact model,
<code class="docutils literal"><span class="pre">get_absolute_url</span></code>. <code class="docutils literal"><span class="pre">get_absolute_url</span></code> is a Django convention for
obtaining the URL of a single model instance. In this case it&#8217;s just
going to be a call to <code class="docutils literal"><span class="pre">reverse</span></code>, but by providing this method, our
model will play nicely with other parts of Django.</p>
<p>And we&#8217;ll add the link to the contact from the contact list.</p>
</div>
</div>



            
              
              <div class="page_footer">
              <h4>Next</h4>
                <a href="forms.html">Form Basics</a>
              </div>
              
            
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Effective Django</a></h1>










<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started with Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_production/index.html">Building for Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_advanced/index.html">Advanced Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgments.html">Acknowledgments</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Getting Started with Django</a><ul>
      <li>Previous: <a href="static.html" title="previous chapter">Using Static Assets</a></li>
      <li>Next: <a href="forms.html" title="next chapter">Form Basics</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<h3>Donate</h3>
<p>
Consider supporting the authors on <a href="https://www.gratipay.com/">Gratipay</a>:
<script data-gratipay-username="nyergler"
        data-gratipay-widget="button"
        src="//gttp.co/v1.js"></script>
</p>

        </div>
      </div>
      <div class="clearer"></div>
  </div>


    <div class="footer">
      &copy;2012-2017, Nathan R. Yergler.
      
      |
      <a href="../_sources/01_intro/additional-views.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>