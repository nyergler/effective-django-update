
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Additional Generic Views &#8212; Effective Django</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0-pre',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Form Basics" href="forms.html" />
    <link rel="prev" title="Using Static Assets" href="static.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="additional-generic-views">
<h1>Additional Generic Views<a class="headerlink" href="#additional-generic-views" title="Permalink to this headline">¶</a></h1>
<div class="section" id="edit-views">
<h2>Edit Views<a class="headerlink" href="#edit-views" title="Permalink to this headline">¶</a></h2>
<p>In addition to creating Contacts, we’ll of course want to edit them.
As with the List and Create views, Django has a generic view we can
use as a starting point.</p>
<div class="literal-diff-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">View file <a class="reference external" href="https://github.com/nyergler/effective-django-tutorial/blob/edit_contact_view/contacts/views.py">contacts/views.py</a></span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CreateContactView</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Contact</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;edit_contact.html&#39;</span>

<span class="o">...</span>

    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">CreateContactView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;contacts-new&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">context</span>
</pre></div>
</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="k">import</span> <span class="n">UpdateView</span>
<span class="o">...</span>
<span class="k">class</span> <span class="nc">UpdateContactView</span><span class="p">(</span><span class="n">UpdateView</span><span class="p">):</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Contact</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;edit_contact.html&#39;</span>

    <span class="k">def</span> <span class="nf">get_success_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;contacts-list&#39;</span><span class="p">)</span>

</pre></div>
</div>
<ul class="simple">
<li>we can re-use the same template</li>
<li>but how does it know which contact to load?</li>
<li>we need to either: provide a pk/slug, or override get_object().</li>
<li>we’ll provide pk in the URL</li>
</ul>
<div class="literal-diff-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">View file <a class="reference external" href="https://github.com/nyergler/effective-django-tutorial/blob/edit_contact_view/addressbook/urls.py">addressbook/urls.py</a></span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">ListContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-list&#39;</span><span class="p">,),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^new$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">CreateContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-new&#39;</span><span class="p">,),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^edit/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">UpdateContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-edit&#39;</span><span class="p">,),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>We’ll update the contact list to include an edit link next to each
contact.</p>
<div class="highlight-django"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;base.html&quot;</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">&lt;h1&gt;Contacts&lt;/h1&gt;</span>

<span class="x">&lt;ul&gt;</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">contact</span> <span class="k">in</span> <span class="nv">object_list</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    &lt;li class=&quot;contact&quot;&gt;</span><span class="cp">{{</span> <span class="nv">contact</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">      (&lt;a href=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s2">&quot;contacts-edit&quot;</span> <span class="nv">pk</span><span class="o">=</span><span class="nv">contact.id</span> <span class="cp">%}</span><span class="x">&quot;&gt;edit&lt;/a&gt;)</span>
<span class="x">    &lt;/li&gt;</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">&lt;/ul&gt;</span>

<span class="x">&lt;a href=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s2">&quot;contacts-new&quot;</span> <span class="cp">%}</span><span class="x">&quot;&gt;add contact&lt;/a&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<p>Note the use of <code class="docutils literal"><span class="pre">pk=contact.id</span></code> in the <code class="docutils literal"><span class="pre">{%</span> <span class="pre">url</span> <span class="pre">%}</span></code> tag to specify
the arguments to fill into the URL pattern.</p>
<p>If you run the server now, you’ll see an edit link. Go ahead and click
it, and try to make a change. You’ll notice that instead of editing
the existing record, it creates a new one. Sad face.</p>
<p>If we look at the source of the edit HTML, we can easily see the
reason: the form targets <code class="docutils literal"><span class="pre">/new</span></code>, not our edit URL. To fix this –
and still allow re-using the template – we’re going to add some
information to the <a href="#id8"><span class="problematic" id="id9">`template context`_</span></a>.</p>
<p>The template context is the information available to a template when
it’s rendered. This is a combination of information you provide in
your view – either directly or indirectly – and information added by
<a class="reference external" href="https://docs.djangoproject.com/en/1.11/ref/templates/api/#subclassing-context-requestcontext">context processors</a>, such as the location for static media and
current locale. In order to use the same template for add and edit,
we’ll add information about where the form should redirect to the
context.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CreateContactView</span><span class="p">(</span><span class="n">CreateView</span><span class="p">):</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Contact</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;edit_contact.html&#39;</span>

    <span class="k">def</span> <span class="nf">get_success_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;contacts-list&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">CreateContactView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;contacts-new&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">context</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">UpdateContactView</span><span class="p">(</span><span class="n">UpdateView</span><span class="p">):</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Contact</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;edit_contact.html&#39;</span>

    <span class="k">def</span> <span class="nf">get_success_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;contacts-list&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_context_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="n">context</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">UpdateContactView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get_context_data</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">context</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;contacts-edit&#39;</span><span class="p">,</span>
                                    <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object</span><span class="p">()</span><span class="o">.</span><span class="n">id</span><span class="p">})</span>

        <span class="k">return</span> <span class="n">context</span>
</pre></div>
</div>
<p>We also update the template to use that value for the action and
change the title based on whether or not we’ve previously saved.</p>
<div class="highlight-django"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">contact.id</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">&lt;h1&gt;Edit Contact&lt;/h1&gt;</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">&lt;h1&gt;Add Contact&lt;/h1&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">&lt;form action=&quot;</span><span class="cp">{{</span> <span class="nv">action</span> <span class="cp">}}</span><span class="x">&quot; method=&quot;POST&quot;&gt;</span>
</pre></div>
</div>
<p>You may wonder where the <code class="docutils literal"><span class="pre">contact</span></code> value in the contact comes from.
The class based views that wrap a single object (those that take
a primary key or slug) expose that to the context in two different
ways: as a variable named <code class="docutils literal"><span class="pre">object</span></code>, and as a variable named after
the model class. The latter often makes your templates easier to read
and understand later. (You can customize this name by overriding
<code class="docutils literal"><span class="pre">get_context_object_name</span></code> on your view.)</p>
<div class="sidebar">
<p class="first sidebar-title">Made a Change? Run the Tests.</p>
<p>We’ve just made a change to our <code class="docutils literal"><span class="pre">CreateContactView</span></code>, which means
this is a perfect time to run the tests we wrote. Do they still pass?
If not, did we introduce a bug, or did the behavior change in a way
that we expected?</p>
<p class="last">(Hint: We changed how the contact list is rendered, so our tests
that just expect the name there are going to fail. This is a case
where you’d need to update the test case, but it also demonstrates
how integration tests can be fragile.)</p>
</div>
</div>
<div class="section" id="deleting-contacts">
<h2>Deleting Contacts<a class="headerlink" href="#deleting-contacts" title="Permalink to this headline">¶</a></h2>
<p>The final view for our basic set of views is delete. The generic
deletion view is very similar to the edit view: it wraps a single
object and requires that you provide a URL to redirect to on success.
When it processes a HTTP GET request, it displays a confirmation page,
and when it receives an HTTP DELETE or POST, it deletes the object and
redirects to the success URL.</p>
<p>We add the view definition to <code class="docutils literal"><span class="pre">views.py</span></code>:</p>
<div class="literal-diff-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">View file <a class="reference external" href="https://github.com/nyergler/effective-django-tutorial/blob/delete_contact_view/contacts/views.py">contacts/views.py</a></span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DeleteContactView</span><span class="p">(</span><span class="n">DeleteView</span><span class="p">):</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Contact</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;delete_contact.html&#39;</span>

    <span class="k">def</span> <span class="nf">get_success_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;contacts-list&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And create the template, <code class="docutils literal"><span class="pre">delete_contact.html</span></code>, in our <code class="docutils literal"><span class="pre">templates</span></code>
directory.</p>
<div class="highlight-django"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;base.html&quot;</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">block</span> <span class="nv">content</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">&lt;h1&gt;Delete Contact&lt;/h1&gt;</span>

<span class="x">&lt;p&gt;Are you sure you want to delete the contact </span><span class="cp">{{</span> <span class="nv">contact</span> <span class="cp">}}</span><span class="x">?&lt;/p&gt;</span>

<span class="x">&lt;form action=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s2">&quot;contacts-delete&quot;</span> <span class="nv">pk</span><span class="o">=</span><span class="nv">contact.id</span> <span class="cp">%}</span><span class="x">&quot; method=&quot;POST&quot;&gt;</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">csrf_token</span> <span class="cp">%}</span><span class="x"></span>

<span class="x">  &lt;input type=&quot;submit&quot; value=&quot;Yes, delete.&quot; /&gt;</span>
<span class="x">  &lt;a href=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s2">&quot;contacts-list&quot;</span> <span class="cp">%}</span><span class="x">&quot;&gt;No, cancel.&lt;/a&gt;</span>
<span class="x">&lt;/form&gt;</span>

<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<p>Of course we need to add this to the URL definitions:</p>
<div class="literal-diff-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">View file <a class="reference external" href="https://github.com/nyergler/effective-django-tutorial/blob/delete_contact_view/addressbook/urls.py">addressbook/urls.py</a></span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">ListContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-list&#39;</span><span class="p">,),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^new$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">CreateContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-new&#39;</span><span class="p">,),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^edit/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">UpdateContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-edit&#39;</span><span class="p">,),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^delete/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">DeleteContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-delete&#39;</span><span class="p">,),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>And we’ll add the link to delete to the edit page.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="n">contact</span><span class="o">.</span><span class="n">id</span> <span class="o">%</span><span class="p">}</span>
<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;{</span><span class="si">% u</span><span class="s2">rl &quot;</span><span class="n">contacts</span><span class="o">-</span><span class="n">delete</span><span class="s2">&quot; pk=contact.id %}&quot;</span><span class="o">&gt;</span><span class="n">Delete</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
<span class="p">{</span><span class="o">%</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="detail-view">
<h2>Detail View<a class="headerlink" href="#detail-view" title="Permalink to this headline">¶</a></h2>
<p>Finally, let’s go ahead and add a detail view for our Contacts. This
will show the details of the Contact: not much right now, but we’ll
build on this shortly. Django includes a generic <code class="docutils literal"><span class="pre">DetailView</span></code>: think
of it as the single serving <code class="docutils literal"><span class="pre">ListView</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="k">import</span> <span class="n">DetailView</span>
<span class="o">...</span>
<span class="k">class</span> <span class="nc">ContactView</span><span class="p">(</span><span class="n">DetailView</span><span class="p">):</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Contact</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;contact.html&#39;</span>
</pre></div>
</div>
<div class="literal-diff-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">View file <a class="reference external" href="https://github.com/nyergler/effective-django-tutorial/blob/contact_detail_view/contacts/views.py">contacts/views.py</a></span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ContactView</span><span class="p">(</span><span class="n">DetailView</span><span class="p">):</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Contact</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;contact.html&#39;</span>
</pre></div>
</div>
</div>
<p>Again, the template is pretty straight forward; we create
<code class="docutils literal"><span class="pre">contact.html</span></code> in the <code class="docutils literal"><span class="pre">templates</span></code> directory.</p>
<div class="highlight-html"><div class="highlight"><pre><span></span>{% extends &quot;base.html&quot; %}

{% block content %}

<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ contact }}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Email: {{ contact.email }}<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

{% endblock %}
</pre></div>
</div>
<p>And add the URL mapping:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="mf">1.</span> <span class="n">Add</span> <span class="n">an</span> <span class="n">import</span><span class="p">:</span>  <span class="kn">from</span> <span class="nn">other_app.views</span> <span class="k">import</span> <span class="n">Home</span>
    <span class="mf">2.</span> <span class="n">Add</span> <span class="n">a</span> <span class="n">URL</span> <span class="n">to</span> <span class="n">urlpatterns</span><span class="p">:</span>  <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span> <span class="n">Home</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;home&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="literal-diff-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">View file <a class="reference external" href="https://github.com/nyergler/effective-django-tutorial/blob/contact_detail_view/addressbook/urls.py">addressbook/urls.py</a></span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">ListContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-list&#39;</span><span class="p">,),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(?P&lt;pk&gt;\d+)/$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">ContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-view&#39;</span><span class="p">,),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^new$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">CreateContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-new&#39;</span><span class="p">,),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^edit/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">UpdateContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-edit&#39;</span><span class="p">,),</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^delete/(?P&lt;pk&gt;\d+)/$&#39;</span><span class="p">,</span> <span class="n">contacts</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">DeleteContactView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contacts-delete&#39;</span><span class="p">,),</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<p>We’re also going to add a method to our Contact model,
<code class="docutils literal"><span class="pre">get_absolute_url</span></code>. <code class="docutils literal"><span class="pre">get_absolute_url</span></code> is a Django convention for
obtaining the URL of a single model instance. In this case it’s just
going to be a call to <code class="docutils literal"><span class="pre">reverse</span></code>, but by providing this method, our
model will play nicely with other parts of Django.</p>
<div class="literal-diff-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">View file <a class="reference external" href="https://github.com/nyergler/effective-django-tutorial/blob/contact_detail_view/contacts/models.py">contacts/models.py</a></span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.core.urlresolvers</span> <span class="kn">import</span> <span class="n">reverse</span>

<span class="o">...</span>

<span class="k">class</span> <span class="nc">Contact</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="n">first_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span>

    <span class="p">)</span>

    <span class="n">email</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">EmailField</span><span class="p">()</span>

<span class="o">...</span>

    <span class="k">def</span> <span class="nf">get_absolute_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;contacts-view&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Contact</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<span class="o">...</span>
    <span class="k">def</span> <span class="nf">get_absolute_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;contacts-view&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;pk&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">})</span>
</pre></div>
</div>
<p>And we’ll add the link to the contact from the contact list.</p>
<div class="highlight-django"><div class="highlight"><pre><span></span><span class="x">  </span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">contact</span> <span class="k">in</span> <span class="nv">object_list</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    &lt;li class=&quot;contact&quot;&gt;</span>
<span class="x">      &lt;a href=&quot;</span><span class="cp">{{</span> <span class="nv">contact.get_absolute_url</span> <span class="cp">}}</span><span class="x">&quot;&gt;</span><span class="cp">{{</span> <span class="nv">contact</span> <span class="cp">}}</span><span class="x">&lt;/a&gt;</span>
<span class="x">      (&lt;a href=&quot;</span><span class="cp">{%</span> <span class="k">url</span> <span class="s2">&quot;contacts-edit&quot;</span> <span class="nv">pk</span><span class="o">=</span><span class="nv">contact.id</span> <span class="cp">%}</span><span class="x">&quot;&gt;edit&lt;/a&gt;)</span>
<span class="x">    &lt;/li&gt;</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
</div>



            
              
              <div class="page_footer">
              <h4>Next</h4>
                <a href="forms.html">Form Basics</a>
              </div>
              
            
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Effective Django</a></h1>










<h4><a href="../contents.html">Table of Contents</a></h4>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Getting Started with Django</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting-started.html">Creating a Django Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">Using Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="views.html">Writing Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="static.html">Using Static Assets</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Additional Generic Views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#edit-views">Edit Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deleting-contacts">Deleting Contacts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#detail-view">Detail View</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="forms.html">Form Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="related.html">Related Models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../02_production/index.html">Building for Production</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_advanced/index.html">Advanced Django</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgments.html">Acknowledgments</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../contents.html">Documentation overview</a><ul>
  <li><a href="index.html">Getting Started with Django</a><ul>
      <li>Previous: <a href="static.html" title="previous chapter">Using Static Assets</a></li>
      <li>Next: <a href="forms.html" title="next chapter">Form Basics</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<h3>Donate</h3>
<p>
Consider supporting the authors on <a href="https://www.gratipay.com/">Gratipay</a>:
</p>
<script data-gratipay-teamslug="effectivedjango"
  src="https://grtp.co/v2.js" async></script>

        </div>
      </div>
      <div class="clearer"></div>
  </div>


    <div class="footer">
      
      &copy; 2012-2017, <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.yergler.net/" property="cc:attributionName" rel="cc:attributionURL">Nathan Yergler</a>; licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0 license</a>.
      
      |
      <a href="../_sources/01_intro/additional-views.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>